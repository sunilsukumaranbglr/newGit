chapter 2 modified for version 3.