chapter 1 modified for version 4 in Branch - safe.