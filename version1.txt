chapter 1 modified for version 2.